import pandas as pd
import json

# –°–æ–∑–¥–∞–¥–∏–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –æ–±—É—á–∞—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ä—É—Å—Å–∫–æ—è–∑—ã—á–Ω–æ–≥–æ –±–æ—Ç–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ
training_data = {
    "intents": [
        {
            "tag": "greeting",
            "patterns": [
                "–ø—Ä–∏–≤–µ—Ç",
                "–∑–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ", 
                "–¥–æ–±—Ä—ã–π –¥–µ–Ω—å",
                "–¥–æ–±—Ä–æ–µ —É—Ç—Ä–æ",
                "–¥–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å",
                "hi",
                "hello"
            ],
            "responses": [
                "–ü—Ä–∏–≤–µ—Ç! –Ø –≤–∞—à –ø–æ–º–æ—â–Ω–∏–∫ –ø–æ –∏–∑—É—á–µ–Ω–∏—é –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ —è–∑—ã–∫–∞. –ö–∞–∫ –¥–µ–ª–∞?",
                "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –ì–æ—Ç–æ–≤—ã –∏–∑—É—á–∞—Ç—å –∞–Ω–≥–ª–∏–π—Å–∫–∏–π —Å–µ–≥–æ–¥–Ω—è?",
                "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –∏–∑—É—á–µ–Ω–∏–µ –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ! –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?"
            ],
            "context_set": ""
        },
        {
            "tag": "grammar_question",
            "patterns": [
                "–æ–±—ä—è—Å–Ω–∏ –≥—Ä–∞–º–º–∞—Ç–∏–∫—É",
                "—Ä–∞—Å—Å–∫–∞–∂–∏ –æ –≤—Ä–µ–º–µ–Ω–∞—Ö",
                "–∫–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å present simple",
                "—á—Ç–æ —Ç–∞–∫–æ–µ past tense",
                "–ø–æ–º–æ–≥–∏ —Å –≥—Ä–∞–º–º–∞—Ç–∏–∫–æ–π",
                "–Ω–µ –ø–æ–Ω–∏–º–∞—é –≤—Ä–µ–º–µ–Ω–∞",
                "–æ–±—ä—è—Å–Ω–∏ –ø—Ä–∞–≤–∏–ª–æ"
            ],
            "responses": [
                "–î–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä–µ–º –≥—Ä–∞–º–º–∞—Ç–∏–∫—É! –ö–∞–∫—É—é —Ç–µ–º—É –≤–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç: –≤—Ä–µ–º–µ–Ω–∞, –∞—Ä—Ç–∏–∫–ª–∏, –ø—Ä–µ–¥–ª–æ–≥–∏?",
                "–ì—Ä–∞–º–º–∞—Ç–∏–∫–∞ - –æ—Å–Ω–æ–≤–∞ —è–∑—ã–∫–∞. –ù–∞—á–Ω–µ–º —Å –ø—Ä–æ—Å—Ç—ã—Ö –≤—Ä–µ–º–µ–Ω –∏–ª–∏ –µ—Å—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –≤–æ–ø—Ä–æ—Å?",
                "–Ø –ø–æ–º–æ–≥—É —Å –≥—Ä–∞–º–º–∞—Ç–∏–∫–æ–π! –í—ã–±–µ—Ä–∏—Ç–µ —Ç–µ–º—É –∏–ª–∏ –∑–∞–¥–∞–π—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –≤–æ–ø—Ä–æ—Å."
            ],
            "context_set": "grammar"
        },
        {
            "tag": "vocabulary_request",
            "patterns": [
                "—Ö–æ—á—É –≤—ã—É—á–∏—Ç—å –Ω–æ–≤—ã–µ —Å–ª–æ–≤–∞",
                "–¥–∞–π —Å–ª–æ–≤–∞—Ä—å",
                "–∏–∑—É—á–∞–µ–º –ª–µ–∫—Å–∏–∫—É",
                "–Ω–æ–≤—ã–µ —Å–ª–æ–≤–∞",
                "—Å–ª–æ–≤–∞—Ä–Ω—ã–π –∑–∞–ø–∞—Å",
                "vocabulary",
                "—É—á–∏—Ç—å —Å–ª–æ–≤–∞"
            ],
            "responses": [
                "–û—Ç–ª–∏—á–Ω–æ! –í—ã–±–µ—Ä–∏—Ç–µ —Ç–µ–º—É –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è —Å–ª–æ–≤: –µ–¥–∞, –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è, —Ä–∞–±–æ—Ç–∞, —Å–µ–º—å—è?",
                "–ò–∑—É—á–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Å–ª–æ–≤ - –∫–ª—é—á –∫ —É—Å–ø–µ—Ö—É! –ö–∞–∫–∞—è —Ç–µ–º–∞ –≤–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç?",
                "–ü–æ–ø–æ–ª–Ω–∏–º —Å–ª–æ–≤–∞—Ä–Ω—ã–π –∑–∞–ø–∞—Å! –û —á–µ–º —Ö–æ—Ç–µ–ª–∏ –±—ã —É–∑–Ω–∞—Ç—å –Ω–æ–≤—ã–µ —Å–ª–æ–≤–∞?"
            ],
            "context_set": "vocabulary"
        },
        {
            "tag": "translation_request",
            "patterns": [
                "–ø–µ—Ä–µ–≤–µ–¥–∏",
                "–∫–∞–∫ —Å–∫–∞–∑–∞—Ç—å –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º",
                "—á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç",
                "translate",
                "–ø–µ—Ä–µ–≤–æ–¥",
                "–∫–∞–∫ –±—É–¥–µ—Ç –ø–æ-–∞–Ω–≥–ª–∏–π—Å–∫–∏"
            ],
            "responses": [
                "–° —Ä–∞–¥–æ—Å—Ç—å—é –ø–µ—Ä–µ–≤–µ–¥—É! –ù–∞–ø–∏—à–∏—Ç–µ —Å–ª–æ–≤–æ –∏–ª–∏ —Ñ—Ä–∞–∑—É –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞.",
                "–ö–æ–Ω–µ—á–Ω–æ –ø–æ–º–æ–≥—É —Å –ø–µ—Ä–µ–≤–æ–¥–æ–º! –ß—Ç–æ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–≤–µ—Å—Ç–∏?",
                "–ì–æ—Ç–æ–≤ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—å! –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞."
            ],
            "context_set": "translation"
        },
        {
            "tag": "speaking_practice",
            "patterns": [
                "—Ö–æ—á—É –≥–æ–≤–æ—Ä–∏—Ç—å",
                "–ø—Ä–∞–∫—Ç–∏–∫–∞ —Ä–∞–∑–≥–æ–≤–æ—Ä–∞",
                "–≥–æ–≤–æ—Ä–µ–Ω–∏–µ",
                "pronunciation",
                "–ø—Ä–æ–∏–∑–Ω–æ—à–µ–Ω–∏–µ",
                "speaking",
                "—Ä–∞–∑–≥–æ–≤–æ—Ä"
            ],
            "responses": [
                "–û—Ç–ª–∏—á–Ω–∞—è –∏–¥–µ—è! –ü—Ä–∞–∫—Ç–∏–∫–∞ —Ä–∞–∑–≥–æ–≤–æ—Ä–∞ –æ—á–µ–Ω—å –≤–∞–∂–Ω–∞. –î–∞–≤–∞–π—Ç–µ –Ω–∞—á–Ω–µ–º –ø—Ä–æ—Å—Ç–æ–π –¥–∏–∞–ª–æ–≥!",
                "–ì–æ–≤–æ—Ä–µ–Ω–∏–µ - –≤–∞–∂–Ω—ã–π –Ω–∞–≤—ã–∫! –ù–∞—á–Ω–µ–º —Å –ø—Ä–æ—Å—Ç—ã—Ö —Ñ—Ä–∞–∑ –∏–ª–∏ —Ö–æ—Ç–∏—Ç–µ –¥–∏–∞–ª–æ–≥?",
                "–ü—Ä–∞–∫—Ç–∏–∫—É–µ–º —Ä–∞–∑–≥–æ–≤–æ—Ä! –í—ã–±–µ—Ä–∏—Ç–µ —Ç–µ–º—É: –∑–Ω–∞–∫–æ–º—Å—Ç–≤–æ, –ø–æ–∫—É–ø–∫–∏, –≤ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–µ?"
            ],
            "context_set": "speaking"
        },
        {
            "tag": "progress_check",
            "patterns": [
                "–º–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å",
                "—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞",
                "—Å–∫–æ–ª—å–∫–æ –≤—ã—É—á–∏–ª",
                "–ø—Ä–æ–≥—Ä–µ—Å—Å –æ–±—É—á–µ–Ω–∏—è",
                "–º–æ–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è",
                "progress"
            ],
            "responses": [
                "–í–∞—à–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–±—É—á–µ–Ω–∏—è:\nüìö –ò–∑—É—á–µ–Ω–æ —Å–ª–æ–≤: {words_learned}\n‚è∞ –í—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è: {study_time}\nüéØ –£—Ä–æ–≤–µ–Ω—å: {level}",
                "–û—Ç–ª–∏—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã! –í—ã –∏–∑—É—á–∏–ª–∏ {words_learned} —Å–ª–æ–≤ –∏ –ø—Ä–æ–≤–µ–ª–∏ {study_time} –º–∏–Ω—É—Ç –≤ –æ–±—É—á–µ–Ω–∏–∏!",
                "–í–∞—à –ø—Ä–æ–≥—Ä–µ—Å—Å –≤–ø–µ—á–∞—Ç–ª—è–µ—Ç! –¢–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å: {level}, –∏–∑—É—á–µ–Ω–æ {words_learned} —Å–ª–æ–≤."
            ],
            "context_set": ""
        },
        {
            "tag": "lesson_request",
            "patterns": [
                "—É—Ä–æ–∫",
                "–Ω–∞—á–∞—Ç—å —É—Ä–æ–∫", 
                "lesson",
                "–æ–±—É—á–µ–Ω–∏–µ",
                "—É—á–∏—Ç—å—Å—è",
                "–∑–∞–Ω—è—Ç–∏–µ"
            ],
            "responses": [
                "–û—Ç–ª–∏—á–Ω–æ! –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø —É—Ä–æ–∫–∞:\nüìñ –ì—Ä–∞–º–º–∞—Ç–∏–∫–∞\nüìö –ù–æ–≤—ã–µ —Å–ª–æ–≤–∞\nüó£ –†–∞–∑–≥–æ–≤–æ—Ä–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞\nüìù –£–ø—Ä–∞–∂–Ω–µ–Ω–∏—è",
                "–ù–∞—á–∏–Ω–∞–µ–º —É—Ä–æ–∫! –ß—Ç–æ –∏–∑—É—á–∞–µ–º —Å–µ–≥–æ–¥–Ω—è: –≥—Ä–∞–º–º–∞—Ç–∏–∫—É, –ª–µ–∫—Å–∏–∫—É –∏–ª–∏ –ø—Ä–∞–∫—Ç–∏–∫—É–µ–º –≥–æ–≤–æ—Ä–µ–Ω–∏–µ?",
                "–ì–æ—Ç–æ–≤ –∫ –æ–±—É—á–µ–Ω–∏—é! –ö–∞–∫–æ–π —É—Ä–æ–∫ –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—Ç–µ?"
            ],
            "context_set": "lesson"
        },
        {
            "tag": "help",
            "patterns": [
                "–ø–æ–º–æ—â—å",
                "help",
                "—á—Ç–æ —Ç—ã —É–º–µ–µ—à—å",
                "–∫–æ–º–∞–Ω–¥—ã",
                "–∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è",
                "–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è"
            ],
            "responses": [
                "–Ø –ø–æ–º–æ–≥—É –≤–∞–º –∏–∑—É—á–∞—Ç—å –∞–Ω–≥–ª–∏–π—Å–∫–∏–π! –ú–æ–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:\nüî§ –ò–∑—É—á–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Å–ª–æ–≤\nüìñ –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –≥—Ä–∞–º–º–∞—Ç–∏–∫–∏\nüó£ –ü—Ä–∞–∫—Ç–∏–∫–∞ —Ä–∞–∑–≥–æ–≤–æ—Ä–∞\nüìä –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞\nüåç –ü–µ—Ä–µ–≤–æ–¥—ã",
                "–†–∞–¥ –ø–æ–º–æ—á—å! –Ø —É–º–µ—é:\n- –û–±—É—á–∞—Ç—å –Ω–æ–≤—ã–º —Å–ª–æ–≤–∞–º\n- –û–±—ä—è—Å–Ω—è—Ç—å –≥—Ä–∞–º–º–∞—Ç–∏–∫—É –ø—Ä–æ—Å—Ç—ã–º–∏ —Å–ª–æ–≤–∞–º–∏\n- –ü–æ–º–æ–≥–∞—Ç—å —Å –ø—Ä–æ–∏–∑–Ω–æ—à–µ–Ω–∏–µ–º\n- –ü–µ—Ä–µ–≤–æ–¥–∏—Ç—å —Ç–µ–∫—Å—Ç—ã\n- –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –≤–∞—à –ø—Ä–æ–≥—Ä–µ—Å—Å",
                "–°–ø–∏—Å–æ–∫ –º–æ–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π:\n‚úÖ –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —É—Ä–æ–∫–∏\n‚úÖ –ì—Ä–∞–º–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è\n‚úÖ –°–ª–æ–≤–∞—Ä–Ω—ã–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è\n‚úÖ –†–∞–∑–≥–æ–≤–æ—Ä–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞\n‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–±—É—á–µ–Ω–∏—è"
            ],
            "context_set": ""
        }
    ]
}

# –°–æ—Ö—Ä–∞–Ω–∏–º –¥–∞–Ω–Ω—ã–µ –≤ JSON —Ñ–∞–π–ª
with open('russian_english_bot_training_data.json', 'w', encoding='utf-8') as f:
    json.dump(training_data, f, ensure_ascii=False, indent=2)

# –°–æ–∑–¥–∞–¥–∏–º DataFrame –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
patterns_list = []
for intent in training_data['intents']:
    for pattern in intent['patterns']:
        patterns_list.append({
            'intent': intent['tag'],
            'pattern': pattern,
            'language': 'ru' if any(ord(c) > 127 for c in pattern) else 'en'
        })

df_patterns = pd.DataFrame(patterns_list)
print("–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–±—É—á–∞—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö:")
print(df_patterns.groupby(['intent', 'language']).size().unstack(fill_value=0))

print(f"\n–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤: {len(patterns_list)}")
print(f"–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–Ω—Ç–µ–Ω—Ç–æ–≤: {len(training_data['intents'])}")
print(f"–†—É—Å—Å–∫–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã: {len(df_patterns[df_patterns['language'] == 'ru'])}")
print(f"–ê–Ω–≥–ª–∏–π—Å–∫–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã: {len(df_patterns[df_patterns['language'] == 'en'])}")

df_patterns.head(10)